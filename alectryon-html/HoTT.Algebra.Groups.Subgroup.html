<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Subgroup.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk0"><span class="kn">Require Import</span> Basics Types HFiber WildCat.Core WildCat.Equiv.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Truncations.Core Modalities.Modality.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Export</span> Modalities.Modality (conn_map_factor1_image).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Algebra.Groups.Group Universes.TruncType Universes.HSet.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> mc_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> mc_mult_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Generalizable Variables</span> <span class="nf">G</span> H A B C N f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Subgroups *)</span>

<span class="sd">(** ** Definition of being a subgroup *)</span>

<span class="sd">(** A subgroup H of a group G is a predicate (i.e. an hProp-valued type family) on G which is closed under the group operations. The group underlying H is given by the total space { g : G &amp; H g }, defined in [subgroup_group] below. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsSubgroup</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>) := {
  issubgroup_predicate :: <span class="kr">forall</span> <span class="nv">x</span>, IsHProp (H x) ;
  issubgroup_in_unit : H mon_unit ;
  issubgroup_in_op : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, H x -&gt; H y -&gt; H (x * y) ;
  issubgroup_in_inv : <span class="kr">forall</span> <span class="nv">x</span>, H x -&gt; H x^ ;
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issig_issubgroup</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>) : _ &lt;~&gt; IsSubgroup H
  := <span class="kp">ltac</span>:(issig).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Basic properties of subgroups *)</span>

<span class="sd">(** Smart constructor for subgroups.  *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1"><span class="kn">Definition</span> <span class="nf">Build_IsSubgroup&#39;</span> {<span class="nv">G</span> : Group}
  (<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>) `{<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (H x)}
  (unit : H mon_unit)
  (c : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, H x -&gt; H y -&gt; H (x * y^))
  : IsSubgroup H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3"><span class="nb">refine</span> (Build_IsSubgroup G H _ unit _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk4"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, H x -&gt; H x^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk6"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H y -&gt; H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7"><span class="nb">intros</span> hx hy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8"><span class="nb">pose</span> (c&#39; := c mon_unit y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span><span class="hyp-body"><b>:= </b><span>c <span class="mi">1</span> y</span></span><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span> -&gt; H y -&gt; H (<span class="mi">1</span> * y^)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9"><span class="nb">specialize</span> (c&#39; unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H (<span class="mi">1</span> * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka"><span class="nb">specialize</span> (c x y^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * (y^)^)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H (<span class="mi">1</span> * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb"><span class="nb">rewrite</span> (grp_inv_inv y) <span class="kr">in</span> c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * y)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H (<span class="mi">1</span> * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc"><span class="nb">rewrite</span> left_identity <span class="kr">in</span> c&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * y)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H y^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd"><span class="nb">apply</span> c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * y)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H y^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * y)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H y^</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chke"><hr></label><div class="goal-conclusion">H y^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf"><span class="mi">1</span>: <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H x -&gt; H y^ -&gt; H (x * y)</span></span></span><br><span><var>hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>c'</var><span class="hyp-type"><b>: </b><span>H y -&gt; H y^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H y^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (c&#39; hy).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, H x -&gt; H x^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11"><span class="nb">intro</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H g -&gt; H g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12"><span class="nb">specialize</span> (c _ g unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H g -&gt; H (<span class="mi">1</span> * g^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H g -&gt; H g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13"><span class="nb">rewrite</span> left_identity <span class="kr">in</span> c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>H g -&gt; H g^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H g -&gt; H g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Additional lemmas about being elements in a subgroup *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">IsSubgroupElements</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>  {<span class="nv">G</span> : Group} {<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>} `{IsSubgroup G H}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14"><span class="kn">Definition</span> <span class="nf">issubgroup_in_op_inv</span> (<span class="nv">x</span> <span class="nv">y</span> : G) : H x -&gt; H y -&gt; H (x * y^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H y -&gt; H (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk15"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H y -&gt; H (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk16"><span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk17"><span class="nb">apply</span> issubgroup_in_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk18" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk18"><hr></label><div class="goal-conclusion">H y^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk19"><span class="mi">1</span>: <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H y^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> issubgroup_in_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a"><span class="kn">Definition</span> <span class="nf">issubgroup_in_inv&#39;</span> (<span class="nv">x</span> : G) : H x^ -&gt; H x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x^ -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x^ -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c"><span class="nb">intros</span> p; <span class="nb">rewrite</span> &lt;- (inverse_involutive x); <span class="nb">revert</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x^ -&gt; H (x^)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d"><span class="kn">Definition</span> <span class="nf">issubgroup_in_inv_op</span> (<span class="nv">x</span> <span class="nv">y</span> : G) : H x -&gt; H y -&gt; H (x^ * y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H y -&gt; H (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H y -&gt; H (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f"><span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20"><span class="nb">rewrite</span> &lt;- (inverse_involutive y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * (y^)^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21"><span class="nb">apply</span> issubgroup_in_op_inv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x^</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk22"><hr></label><div class="goal-conclusion">H y^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="mi">1</span>,<span class="mi">2</span>: <span class="bp">by</span> <span class="nb">apply</span> issubgroup_in_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23"><span class="kn">Definition</span> <span class="nf">issubgroup_in_op_l</span> (<span class="nv">x</span> <span class="nv">y</span> : G) : H (x * y) -&gt; H y -&gt; H x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H y -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H y -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk25"><span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H (x * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk26"><span class="nb">rewrite</span> &lt;- (grp_unit_r x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H (x * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk27"><span class="nb">revert</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H y -&gt; H (x * <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk28"><span class="nb">rewrite</span> &lt;- (grp_inv_r y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H y -&gt; H (x * (y * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk29"><span class="nb">rewrite</span> grp_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H y -&gt; H (x * y * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_op_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2a"><span class="kn">Definition</span> <span class="nf">issubgroup_in_op_r</span> (<span class="nv">x</span> <span class="nv">y</span> : G) : H (x * y) -&gt; H x -&gt; H y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H x -&gt; H y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y) -&gt; H x -&gt; H y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2c"><span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H (x * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2d"><span class="nb">rewrite</span> &lt;- (grp_unit_l y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>H (x * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (<span class="mi">1</span> * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2e"><span class="nb">revert</span> q p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H (x * y) -&gt; H (<span class="mi">1</span> * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk2f"><span class="nb">rewrite</span> &lt;- (grp_inv_l x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H (x * y) -&gt; H (x^ * x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk30"><span class="nb">rewrite</span> &lt;- grp_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x -&gt; H (x * y) -&gt; H (x^ * (x * y))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_inv_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">IsSubgroupElements</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Given a predicate H on a group G, being a subgroup is a property. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk31"><span class="kn">Instance</span> <span class="nf">ishprop_issubgroup</span> `{F : Funext} {G : Group} {H : G -&gt; <span class="kt">Type</span>}
  : IsHProp (IsSubgroup H).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsSubgroup H)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsSubgroup H)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (istrunc_equiv_istrunc _ (issig_issubgroup H)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Transporting being a subgroup across a pointwise equivalence. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk33"><span class="kn">Definition</span> <span class="nf">issubgroup_equiv</span> {<span class="nv">G</span> : Group} {<span class="nv">H</span> <span class="nv">K</span> : G -&gt; <span class="kt">Type</span>}
  (<span class="nv">p</span> : <span class="kr">forall</span> <span class="nv">g</span>, H g &lt;~&gt; K g)
  : IsSubgroup H -&gt; IsSubgroup K.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H -&gt; IsSubgroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H -&gt; IsSubgroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk35"><span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk36">snapply Build_IsSubgroup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (K x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk37"><hr></label><div class="goal-conclusion">K <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk38"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, K x -&gt; K y -&gt; K (x * y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk39"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, K x -&gt; K x^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (K x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3b"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (K x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3c">rapply (istrunc_equiv_istrunc (H x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x &lt;~&gt; K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> p, issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, K x -&gt; K y -&gt; K (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk3f"><span class="nb">intros</span> x y inx iny.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>inx</var><span class="hyp-type"><b>: </b><span>K x</span></span></span><br><span><var>iny</var><span class="hyp-type"><b>: </b><span>K y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk40"><span class="nb">apply</span> (p _)^-<span class="mi">1</span> <span class="kr">in</span> inx, iny.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>inx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>iny</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (p _ (issubgroup_in_op x y inx iny)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, K x -&gt; K x^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk42"><span class="nb">intros</span> x inx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>inx</var><span class="hyp-type"><b>: </b><span>K x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K x^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk43"><span class="nb">apply</span> (p _)^-<span class="mi">1</span> <span class="kr">in</span> inx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;~&gt; K g</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>inx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K x^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (p _ (issubgroup_in_inv x inx)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Definition of subgroup *)</span> 

<span class="sd">(** The type (set) of subgroups of a group G. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">Subgroup</span> (<span class="nv">G</span> : Group) := {
  subgroup_pred : G -&gt; <span class="kt">Type</span> ;
  subgroup_issubgroup :: IsSubgroup subgroup_pred ;
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">subgroup_pred</span> : Subgroup &gt;-&gt; <span class="kt">Funclass</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issig_subgroup</span> {<span class="nv">G</span> : Group} : _ &lt;~&gt; Subgroup G
  := <span class="kp">ltac</span>:(issig).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Basics properties of subgroups *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk44"><span class="kn">Definition</span> <span class="nf">Build_Subgroup&#39;</span> {<span class="nv">G</span> : Group}
  (<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>) `{<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (H x)}
  (unit : H mon_unit)
  (c : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, H x -&gt; H y -&gt; H (x * y^))
  : Subgroup G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk45"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk46"><span class="nb">refine</span> (Build_Subgroup G H _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (H x)</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>H <span class="mi">1</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, H x -&gt; H y -&gt; H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">rapply Build_IsSubgroup&#39;; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">SubgroupElements</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G) (<span class="nv">x</span> <span class="nv">y</span> : G).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_unit</span> : H <span class="mi">1</span> := issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_inv</span> : H x -&gt; H x^ := issubgroup_in_inv x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_inv&#39;</span> : H x^ -&gt; H x := issubgroup_in_inv&#39; x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_op</span> : H x -&gt; H y -&gt; H (x * y) := issubgroup_in_op x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_op_inv</span> : H x -&gt; H y -&gt; H (x * y^) := issubgroup_in_op_inv x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_inv_op</span> : H x -&gt; H y -&gt; H (x^ * y) := issubgroup_in_inv_op x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_op_l</span> : H (x * y) -&gt; H y -&gt; H x := issubgroup_in_op_l x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_in_op_r</span> : H (x * y) -&gt; H x -&gt; H y := issubgroup_in_op_r x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">SubgroupElements</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk47"><span class="kn">Instance</span> <span class="nf">isequiv_subgroup_in_inv</span> `(H : Subgroup G) (x : G)
  : IsEquiv (subgroup_in_inv H x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (subgroup_in_inv H x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk48"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (subgroup_in_inv H x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk49">srapply isequiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x^ -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> subgroup_in_inv&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_subgroup_inv</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G) (<span class="nv">x</span> : G)
  : H x &lt;~&gt; H x^ := Build_Equiv _ _ (subgroup_in_inv H x) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4a"><span class="kn">Definition</span> <span class="nf">equiv_subgroup_op_inv</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G) (<span class="nv">x</span> <span class="nv">y</span> : G)
  : H (x * y^) &lt;~&gt; H (y * x^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^) &lt;~&gt; H (y * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^) &lt;~&gt; H (y * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4c">nrefine (_ oE equiv_subgroup_inv _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^)^ &lt;~&gt; H (y * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> grp_inv_op, grp_inv_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Paths between subgroups correspond to homotopies between the underlying predicates. *)</span> 
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4d"><span class="kn">Proposition</span> <span class="nf">equiv_path_subgroup</span> `{F : Funext} {G : Group} (H K : Subgroup G)
  : (H == K) &lt;~&gt; (H = K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H == K &lt;~&gt; H = K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H == K &lt;~&gt; H = K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk4f"><span class="nb">refine</span> ((equiv_ap&#39; issig_subgroup^-<span class="mi">1</span>%equiv _ _)^-<span class="mi">1</span>%equiv oE _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H == K &lt;~&gt;
(H; subgroup_issubgroup G H) =
(K; subgroup_issubgroup G K)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk50"><span class="nb">refine</span> (equiv_path_sigma_hprop _ _ oE _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H == K &lt;~&gt; H = K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_path_arrow.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk51"><span class="kn">Proposition</span> <span class="nf">equiv_path_subgroup&#39;</span> `{U : Univalence} {G : Group} (H K : Subgroup G)
  : (<span class="kr">forall</span> <span class="nv">g</span>:G, H g &lt;-&gt; K g) &lt;~&gt; (H = K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>U</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;-&gt; K g) &lt;~&gt; H = K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk52"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>U</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;-&gt; K g) &lt;~&gt; H = K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk53"><span class="nb">refine</span> (equiv_path_subgroup _ _ oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>U</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">g</span> : G, H g &lt;-&gt; K g) &lt;~&gt; H == K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk54"><span class="nb">apply</span> equiv_functor_forall_id; <span class="nb">intro</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>U</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(H g &lt;-&gt; K g) &lt;~&gt; H g = K g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> equiv_path_iff_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk55"><span class="kn">Instance</span> <span class="nf">ishset_subgroup</span> `{Univalence} {G : Group} : IsHSet (Subgroup G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (Subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk56"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (Subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk57">nrefine (istrunc_equiv_istrunc _ issig_subgroup).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {H : G -&gt; <span class="kt">Type</span> &amp; IsSubgroup H}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk58">nrefine (istrunc_equiv_istrunc _ (equiv_functor_sigma_id _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G -&gt; <span class="kt">Type</span>, <span class="nl">?Goal</span> a &lt;~&gt; IsSubgroup a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk59"><hr></label><div class="goal-conclusion">IsHSet {x : _ &amp; <span class="nl">?Goal</span> x}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G -&gt; <span class="kt">Type</span>, <span class="nl">?Goal</span> a &lt;~&gt; IsSubgroup a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> P; <span class="nb">apply</span> issig_issubgroup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet
  {P : G -&gt; <span class="kt">Type</span> &amp;
  {_ : <span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (P x) &amp;
  {_ : P <span class="mi">1</span> &amp;
  {_ : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, P x -&gt; P y -&gt; P (x * y) &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : G, P x -&gt; P x^}}}}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5c">nrefine (istrunc_equiv_istrunc _ (equiv_sigma_assoc&#39; _ _)^-<span class="mi">1</span>%equiv).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet
  {ap : {a : G -&gt; <span class="kt">Type</span> &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (a x)}
  &amp;
  {_ : ap.<span class="mi">1</span> <span class="mi">1</span> &amp;
  {_
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, ap.<span class="mi">1</span> x -&gt; ap.<span class="mi">1</span> y -&gt; ap.<span class="mi">1</span> (x * y) &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : G, ap.<span class="mi">1</span> x -&gt; ap.<span class="mi">1</span> x^}}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5d">napply istrunc_sigma.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {a : G -&gt; <span class="kt">Type</span> &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (a x)}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk5e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">a</span> : {a : G -&gt; <span class="kt">Type</span> &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (a x)},
IsHSet
  {_ : a.<span class="mi">1</span> <span class="mi">1</span> &amp;
  {_ : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, a.<span class="mi">1</span> x -&gt; a.<span class="mi">1</span> y -&gt; a.<span class="mi">1</span> (x * y) &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : G, a.<span class="mi">1</span> x -&gt; a.<span class="mi">1</span> x^}}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk5f"><span class="mi">2</span>: <span class="nb">intros</span> []; <span class="nb">apply</span> istrunc_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {a : G -&gt; <span class="kt">Type</span> &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (a x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk60">nrefine (istrunc_equiv_istrunc
               _ (equiv_sig_coind (<span class="kr">fun</span> <span class="nv">g</span>:G =&gt; <span class="kt">Type</span>) (<span class="kr">fun</span> <span class="nv">g</span> <span class="nv">x</span> =&gt; IsHProp x))^-<span class="mi">1</span>%equiv).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (G -&gt; {x : <span class="kt">Type</span> &amp; IsHProp x})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Underlying group of a subgroup *)</span>

<span class="sd">(** The group given by a subgroup *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk61"><span class="kn">Definition</span> <span class="nf">subgroup_group</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G) : Group.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Group</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk62"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Group</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk63"><span class="nb">apply</span> (Build_Group (sig H)
      (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; (x.<span class="mi">1</span> * y.<span class="mi">1</span> ; issubgroup_in_op x.<span class="mi">1</span> y.<span class="mi">1</span> x.<span class="mi">2</span> y.<span class="mi">2</span>))
      (<span class="mi">1</span>; issubgroup_in_unit)
      (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (- x.<span class="mi">1</span> ; issubgroup_in_inv _ x.<span class="mi">2</span>))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsGroup {x : _ &amp; H x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk64"><span class="mi">1</span>: <span class="kp">repeat</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {x : _ &amp; H x}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk65" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk65"><hr></label><div class="goal-conclusion">Associative sg_op</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk66"><hr></label><div class="goal-conclusion">LeftIdentity sg_op <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk67" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk67"><hr></label><div class="goal-conclusion">RightIdentity sg_op <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk68"><hr></label><div class="goal-conclusion">LeftInverse sg_op inv <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk69"><hr></label><div class="goal-conclusion">RightInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk6a"><span class="mi">1</span>: <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Associative sg_op</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk6b"><hr></label><div class="goal-conclusion">LeftIdentity sg_op <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk6c"><hr></label><div class="goal-conclusion">RightIdentity sg_op <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk6d"><hr></label><div class="goal-conclusion">LeftInverse sg_op inv <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk6e"><hr></label><div class="goal-conclusion">RightInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="mi">1</span>-<span class="mi">5</span>: grp_auto.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">subgroup_group</span> : Subgroup &gt;-&gt; Group.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The underlying group of a subgroup of [G] has an inclusion map into [G]. *)</span> 
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk6f"><span class="kn">Definition</span> <span class="nf">subgroup_incl</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : subgroup_group H $-&gt; G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H $-&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk70"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H $-&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk71">snapply Build_GroupHomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H -&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk72" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk72"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?grp_homo_map</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk73"><span class="mi">1</span>: <span class="bp">exact</span> pr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving pr1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">hnf</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The inclusion map is an embedding. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">isembedding_subgroup_incl</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : IsEmbedding (subgroup_incl H)
  := <span class="kr">fun</span> <span class="nv">_</span> =&gt; istrunc_equiv_istrunc _ (hfiber_fibration _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Restriction of a group homomorphism to a subgroup. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">grp_homo_restr</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">K</span> : Subgroup G)
  : subgroup_group K $-&gt; H
  := f $o subgroup_incl _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Corestriction of a group homomorphism to a subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk74"><span class="kn">Definition</span> <span class="nf">subgroup_corec</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} {<span class="nv">K</span> : Subgroup H}
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span>, K (f x))
  : G $-&gt; subgroup_group K.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $-&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk75"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $-&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk76">snapply Build_GroupHomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G -&gt; K</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk77" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk77"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?grp_homo_map</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk78">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G -&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (f x; g x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk79">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (f x; g x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7a"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (x * y); g (x * y)) = (f x; g x) * (f y; g y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7b">rapply path_sigma_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (x * y); g (x * y)).<span class="mi">1</span> = ((f x; g x) * (f y; g y)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">snapply grp_homo_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Corestriction is an equivalence on group homomorphisms. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7c"><span class="kn">Definition</span> <span class="nf">equiv_subgroup_corec</span> {<span class="nv">F</span> : Funext}
  (<span class="nv">G</span> : Group) {<span class="nv">H</span> : Group} (<span class="nv">K</span> : Subgroup H)
  : {f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span>, K (f x)} &lt;~&gt; (G $-&gt; subgroup_group K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)} &lt;~&gt; (G $-&gt; K)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)} &lt;~&gt; (G $-&gt; K)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk7e">snapply equiv_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)} -&gt; G $-&gt; K</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk7f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk7f"><hr></label><div class="goal-conclusion">(G $-&gt; K) -&gt; {f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)}</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk80" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk80"><hr></label><div class="goal-conclusion"><span class="nl">?f</span> o <span class="nl">?g</span> == idmap</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk81"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> o <span class="nl">?f</span> == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk82">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)} -&gt; G $-&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (sig_rec subgroup_corec).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk83">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(G $-&gt; K) -&gt; {f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk84"><span class="nb">intros</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{f : G $-&gt; H &amp; <span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk85"><span class="kr">exists</span> (<span class="nv">subgroup_incl</span> <span class="nv">_</span> $o g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, K ((subgroup_incl K $o g) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk86"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; K</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K ((subgroup_incl K $o g) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (g x).<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk87">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sig_rec subgroup_corec
o (<span class="kr">fun</span> <span class="nv">g</span> : G $-&gt; K =&gt;
   (subgroup_incl K $o g; <span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (g x).<span class="mi">2</span>)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk88"><span class="nb">intros</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sig_rec subgroup_corec
  (subgroup_incl K $o g; <span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (g x).<span class="mi">2</span>) = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply equiv_path_grouphomomorphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk89">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">g</span> : G $-&gt; K =&gt;
 (subgroup_incl K $o g; <span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (g x).<span class="mi">2</span>))
o sig_rec subgroup_corec == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8a"><span class="nb">intros</span> [f p].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(subgroup_incl K $o sig_rec subgroup_corec (f; p);
<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (sig_rec subgroup_corec (f; p) x).<span class="mi">2</span>) =
(f; p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8b">rapply path_sigma_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(subgroup_incl K $o sig_rec subgroup_corec (f; p);
<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (sig_rec subgroup_corec (f; p) x).<span class="mi">2</span>).<span class="mi">1</span> =
(f; p).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply equiv_path_grouphomomorphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Functoriality on subgroups. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">functor_subgroup_group</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} {<span class="nv">J</span> : Subgroup G} {<span class="nv">K</span> : Subgroup H}
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span>, J x -&gt; K (f x))
  : subgroup_group J $-&gt; subgroup_group K
  := subgroup_corec (grp_homo_restr f J) (sig_ind _ g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8c"><span class="kn">Definition</span> <span class="nf">grp_iso_subgroup_group</span> {<span class="nv">G</span> <span class="nv">H</span> : Group@{i}}
  {<span class="nv">J</span> : Subgroup@{i i} G} {<span class="nv">K</span> : Subgroup@{i i} H}
  (<span class="nv">e</span> : G $&lt;~&gt; H) (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">x</span>, J x &lt;-&gt; K (e x))
  : subgroup_group J $&lt;~&gt; subgroup_group K.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J $&lt;~&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J $&lt;~&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk8e">snapply cate_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J $-&gt; K</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk8f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk8f"><hr></label><div class="goal-conclusion">K $-&gt; J</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk90" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk90"><hr></label><div class="goal-conclusion"><span class="nl">?f</span> $o <span class="nl">?g</span> $== Id K</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk91" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk91"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> $o <span class="nl">?f</span> $== Id J</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk92">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J $-&gt; K</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> =&gt; fst (f x))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk93">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K $-&gt; J</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk94">nrefine (functor_subgroup_group e^-<span class="mi">1</span>$ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, K x -&gt; J (e^-<span class="mi">1</span>$ x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk95">equiv_intro e x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K (e x) -&gt; J (e^-<span class="mi">1</span>$ (e x))</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk96"><span class="nb">intros</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J (e^-<span class="mi">1</span>$ (e x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk97">nrefine ((eissect e _)^ # _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (snd (f x) k).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk98">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x)) $o
functor_subgroup_group e^-<span class="mi">1</span>$
  (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
     (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
      transport J (eissect e x)^ (snd (f x) k))
   :
   <span class="kr">forall</span> <span class="nv">x</span> : H, K x -&gt; J (e^-<span class="mi">1</span>$ x)) $== Id K</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk99"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x)) $o
 functor_subgroup_group e^-<span class="mi">1</span>$
   (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
      (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
       transport J (eissect e x)^ (snd (f x) k)))) x =
Id K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9a">rapply path_sigma_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x)) $o
  functor_subgroup_group e^-<span class="mi">1</span>$
    (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
       (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
        transport J (eissect e x)^ (snd (f x) k)))) x).<span class="mi">1</span> =
(Id K x).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply eisretr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_subgroup_group e^-<span class="mi">1</span>$
  (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
     (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
      transport J (eissect e x)^ (snd (f x) k))
   :
   <span class="kr">forall</span> <span class="nv">x</span> : H, K x -&gt; J (e^-<span class="mi">1</span>$ x)) $o
functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x)) $==
Id J</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9c"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>J</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(functor_subgroup_group e^-<span class="mi">1</span>$
   (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
      (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
       transport J (eissect e x)^ (snd (f x) k))) $o
 functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x))) x =
Id J x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9d">rapply path_sigma_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; K (e x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>J</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((functor_subgroup_group e^-<span class="mi">1</span>$
    (equiv_ind e (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; K x -&gt; J (e^-<span class="mi">1</span>$ x))
       (<span class="kr">fun</span> (<span class="nv">x</span> : G) (<span class="nv">k</span> : K (e x)) =&gt;
        transport J (eissect e x)^ (snd (f x) k))) $o
  functor_subgroup_group e (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; fst (f x))) x).<span class="mi">1</span> =
(Id J x).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply eissect.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Cosets of subgroups *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Cosets</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Left and right cosets give equivalence relations. *)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The relation of being in a left coset represented by an element. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">in_cosetL</span> : Relation G := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; H (x^ * y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** The relation of being in a right coset represented by an element. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">in_cosetR</span> : Relation G := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; H (x * y^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hint Extern</span> <span class="mi">4</span> =&gt; <span class="kp">progress</span> <span class="nb">unfold</span> in_cosetL : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hint Extern</span> <span class="mi">4</span> =&gt; <span class="kp">progress</span> <span class="nb">unfold</span> in_cosetR : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Arguments</span> in_cosetL /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Arguments</span> in_cosetR /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** These are props *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">ishprop_in_cosetL</span> : is_mere_relation G in_cosetL := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">ishprop_in_cosetR</span> : is_mere_relation G in_cosetR := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** In fact, they are both equivalence relations. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9e">#[export] <span class="kn">Instance</span> <span class="nf">reflexive_in_cosetL</span> : Reflexive in_cosetL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk9f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka0"><span class="nb">intro</span> x; <span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka1"><span class="nb">rewrite</span> left_inverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka2">#[export] <span class="kn">Instance</span> <span class="nf">reflexive_in_cosetR</span> : Reflexive in_cosetR.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka4"><span class="nb">intro</span> x; <span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka5"><span class="nb">rewrite</span> right_inverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka6">#[export] <span class="kn">Instance</span> <span class="nf">symmetric_in_cosetL</span> : Symmetric in_cosetL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka8"><span class="nb">intros</span> x y h; <span class="nb">cbn</span>; <span class="nb">cbn</span> <span class="kr">in</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (y^ * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chka9"><span class="nb">rewrite</span> &lt;- (grp_inv_inv x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (y^ * (x^)^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkaa"><span class="nb">rewrite</span> &lt;- grp_inv_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * y)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_inv; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkab">#[export] <span class="kn">Instance</span> <span class="nf">symmetric_in_cosetR</span> : Symmetric in_cosetR.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkac"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Symmetric in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkad"><span class="nb">intros</span> x y h; <span class="nb">cbn</span>; <span class="nb">cbn</span> <span class="kr">in</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (y * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkae"><span class="nb">rewrite</span> &lt;- (grp_inv_inv y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H ((y^)^ * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkaf"><span class="nb">rewrite</span> &lt;- grp_inv_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_inv; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb0">#[export] <span class="kn">Instance</span> <span class="nf">transitive_in_cosetL</span> : Transitive in_cosetL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive in_cosetL</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb2"><span class="nb">intros</span> x y z h k; <span class="nb">cbn</span>; <span class="nb">cbn</span> <span class="kr">in</span> h; <span class="nb">cbn</span> <span class="kr">in</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y^ * z)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb3"><span class="nb">rewrite</span> &lt;- (right_identity x^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y^ * z)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * <span class="mi">1</span> * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb4"><span class="nb">rewrite</span> &lt;- (right_inverse y : y * y^ = mon_unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y^ * z)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * (y * y^) * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb5"><span class="nb">rewrite</span> (associativity x^ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y^ * z)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * y * y^ * z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb6"><span class="nb">rewrite</span> &lt;- simple_associativity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x^ * y)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y^ * z)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x^ * y * (y^ * z))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_op; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb7">#[export] <span class="kn">Instance</span> <span class="nf">transitive_in_cosetR</span> : Transitive in_cosetR.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Transitive in_cosetR</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkb9"><span class="nb">intros</span> x y z h k; <span class="nb">cbn</span>; <span class="nb">cbn</span> <span class="kr">in</span> h; <span class="nb">cbn</span> <span class="kr">in</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y * z^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * z^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkba"><span class="nb">rewrite</span> &lt;- (right_identity x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y * z^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * <span class="mi">1</span> * z^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkbb"><span class="nb">rewrite</span> &lt;- (left_inverse y : y^ * y = mon_unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y * z^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * (y^ * y) * z^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkbc"><span class="nb">rewrite</span> (simple_associativity x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y * z^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^ * y * z^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkbd"><span class="nb">rewrite</span> &lt;- (associativity _ _ z^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H (x * y^)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>H (y * z^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^ * (y * z^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> issubgroup_in_op; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Cosets</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Properties of left and right cosets *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkbe"><span class="kn">Definition</span> <span class="nf">in_cosetL_unit</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : Subgroup G}
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, in_cosetL N (x^ * y) mon_unit &lt;~&gt; in_cosetL N x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
in_cosetL N (x^ * y) <span class="mi">1</span> &lt;~&gt; in_cosetL N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkbf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
in_cosetL N (x^ * y) <span class="mi">1</span> &lt;~&gt; in_cosetL N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc0"><span class="nb">intros</span> x y; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N ((x^ * y)^ * <span class="mi">1</span>) &lt;~&gt; N (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc1"><span class="nb">rewrite</span> (right_identity _^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x^ * y)^ &lt;~&gt; N (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc2"><span class="nb">rewrite</span> (inverse_sg_op _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * (x^)^) &lt;~&gt; N (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc3"><span class="nb">rewrite</span> (inverse_involutive _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * x) &lt;~&gt; N (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_iff_hprop; <span class="nb">apply</span> symmetric_in_cosetL.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc4"><span class="kn">Definition</span> <span class="nf">in_cosetR_unit</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : Subgroup G}
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, in_cosetR N (x * y^) mon_unit &lt;~&gt; in_cosetR N x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
in_cosetR N (x * y^) <span class="mi">1</span> &lt;~&gt; in_cosetR N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
in_cosetR N (x * y^) <span class="mi">1</span> &lt;~&gt; in_cosetR N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc6"><span class="nb">intros</span> x y; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y^ * <span class="mi">1</span>^) &lt;~&gt; N (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc7"><span class="nb">rewrite</span> inverse_mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y^ * <span class="mi">1</span>) &lt;~&gt; N (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc8"><span class="nb">rewrite</span> (right_identity (x * y^)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y^) &lt;~&gt; N (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Symmetry is an equivalence. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkc9"><span class="kn">Definition</span> <span class="nf">equiv_in_cosetL_symm</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : Subgroup G}
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, in_cosetL N x y &lt;~&gt; in_cosetL N y x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, in_cosetL N x y &lt;~&gt; in_cosetL N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkca"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, in_cosetL N x y &lt;~&gt; in_cosetL N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkcb"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x y &lt;~&gt; in_cosetL N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkcc">srapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x y -&gt; in_cosetL N y x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkcd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkcd"><hr></label><div class="goal-conclusion">in_cosetL N y x -&gt; in_cosetL N x y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="bp">by</span> <span class="nb">intro</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkce"><span class="kn">Definition</span> <span class="nf">equiv_in_cosetR_symm</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : Subgroup G}
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, in_cosetR N x y &lt;~&gt; in_cosetR N y x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, in_cosetR N x y &lt;~&gt; in_cosetR N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkcf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, in_cosetR N x y &lt;~&gt; in_cosetR N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd0"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x y &lt;~&gt; in_cosetR N y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd1">srapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x y -&gt; in_cosetR N y x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkd2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkd2"><hr></label><div class="goal-conclusion">in_cosetR N y x -&gt; in_cosetR N x y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="bp">by</span> <span class="nb">intro</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sigma type of a left coset is equivalent to the sigma type of the subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd3"><span class="kn">Definition</span> <span class="nf">equiv_sigma_in_cosetL_subgroup</span> (<span class="nv">G</span> : Group) (<span class="nv">H</span> : Subgroup G) (<span class="nv">x</span> : G)
  : sig (in_cosetL H x) &lt;~&gt; sig H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : _ &amp; in_cosetL H x x0} &lt;~&gt; {x : _ &amp; H x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : _ &amp; in_cosetL H x x0} &lt;~&gt; {x : _ &amp; H x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd5">snapply equiv_functor_sigma&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G &lt;~&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkd6"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G, in_cosetL H x a &lt;~&gt; H (<span class="nl">?f</span> a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G &lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">rapply (Build_Equiv _ _ (x^ *.)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G,
in_cosetL H x a &lt;~&gt;
H
  ({|
     equiv_fun := sg_op x^;
     equiv_isequiv := isequiv_group_left_op x^
   |} a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sigma type of a right coset is equivalent to the sigma type of the subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkd9"><span class="kn">Definition</span> <span class="nf">equiv_sigma_in_cosetR_subgroup</span> (<span class="nv">G</span> : Group) (<span class="nv">H</span> : Subgroup G) (<span class="nv">x</span> : G)
  : sig (in_cosetR H x) &lt;~&gt; sig H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : _ &amp; in_cosetR H x x0} &lt;~&gt; {x : _ &amp; H x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkda"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : _ &amp; in_cosetR H x x0} &lt;~&gt; {x : _ &amp; H x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkdb">snapply equiv_functor_sigma&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G &lt;~&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkdc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkdc"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G, in_cosetR H x a &lt;~&gt; H (<span class="nl">?f</span> a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkdd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G &lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">rapply (Build_Equiv _ _ (.* x ^)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkde">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G,
in_cosetR H x a &lt;~&gt;
H
  ({|
     equiv_fun := <span class="kr">fun</span> <span class="nv">y</span> : G =&gt; y * x^;
     equiv_isequiv := isequiv_group_right_op G x^
   |} a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkdf"><span class="nb">simpl</span>; <span class="nb">intros</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (x * y^) &lt;~&gt; H (y * x^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_subgroup_op_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Normal subgroups *)</span>

<span class="sd">(** A normal subgroup is a subgroup closed under conjugation. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsNormalSubgroup</span> {<span class="nv">G</span> : Group} (<span class="nv">N</span> : Subgroup G)
  := isnormal : <span class="kr">forall</span> {<span class="nv">x</span> <span class="nv">y</span>}, N (x * y) -&gt; N (y * x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">NormalSubgroup</span> (<span class="nv">G</span> : Group) := {
  normalsubgroup_subgroup : Subgroup G ;
  normalsubgroup_isnormal :: IsNormalSubgroup normalsubgroup_subgroup ;
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> Build_NormalSubgroup G N _ : <span class="nb">rename</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">normalsubgroup_subgroup</span> : NormalSubgroup &gt;-&gt; Subgroup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke0"><span class="kn">Definition</span> <span class="nf">equiv_symmetric_in_normalsubgroup</span> {<span class="nv">G</span> : Group}
  (<span class="nv">N</span> : Subgroup G) `{!IsNormalSubgroup N}
  : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, N (x * y) &lt;~&gt; N (y * x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N (x * y) &lt;~&gt; N (y * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N (x * y) &lt;~&gt; N (y * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke2"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y) &lt;~&gt; N (y * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke3">rapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y) -&gt; N (y * x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chke4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chke4"><hr></label><div class="goal-conclusion">N (y * x) -&gt; N (x * y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="bp">exact</span> isnormal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Our definition of normal subgroup implies the usual definition of invariance under conjugation. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke5"><span class="kn">Definition</span> <span class="nf">isnormal_conj</span> {<span class="nv">G</span> : Group} (<span class="nv">N</span> : Subgroup G)
  `{!IsNormalSubgroup N} {x y : G}
  : N x &lt;~&gt; N (y * x * y^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N x &lt;~&gt; N (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N x &lt;~&gt; N (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke7">srefine (equiv_symmetric_in_normalsubgroup N _ _ oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N x &lt;~&gt; N (y^ * (y * x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> grp_inv_V_gg.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We can show a subgroup is normal if it is invariant under conjugation. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke8"><span class="kn">Definition</span> <span class="nf">Build_IsNormalSubgroup&#39;</span> (<span class="nv">G</span> : Group) (<span class="nv">N</span> : Subgroup G)
  (<span class="nv">isnormal</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, N x -&gt; N (y * x * y^))
  : IsNormalSubgroup N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chke9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkea"><span class="nb">intros</span> x y n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkeb">nrefine (transport N (grp_unit_r _) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y * x * <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkec">nrefine (transport (<span class="kr">fun</span> <span class="nv">z</span> =&gt; N (_ * z)) (grp_inv_r y) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y * x * (y * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chked">nrefine (transport N (grp_assoc _ _ _)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y * x * y * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkee">nrefine (transport (<span class="kr">fun</span> <span class="nv">z</span> =&gt; N (z * _)) (grp_assoc _ _ _) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>isnormal</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y * (x * y) * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> isnormal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Under funext, being a normal subgroup is a hprop. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkef"><span class="kn">Instance</span> <span class="nf">ishprop_isnormalsubgroup</span> `{Funext} {G : Group} (N : Subgroup G)
  : IsHProp (IsNormalSubgroup N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsNormalSubgroup N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsNormalSubgroup N)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">unfold</span> IsNormalSubgroup; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Our definition of normal subgroup and the usual definition are therefore equivalent. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf1"><span class="kn">Definition</span> <span class="nf">equiv_isnormal_conjugate</span> `{Funext} {G : Group} (N : Subgroup G)
  : IsNormalSubgroup N &lt;~&gt; (<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, N x -&gt; N (y * x * y^)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf3">rapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N -&gt;
<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkf4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkf4"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)) -&gt;
IsNormalSubgroup N</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N -&gt;
<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf6"><span class="nb">intros</span> is_normal x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>is_normal</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N x -&gt; N (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">rapply isnormal_conj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)) -&gt;
IsNormalSubgroup N</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf8"><span class="nb">intros</span> is_normal&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>is_normal'</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, N x -&gt; N (y * x * y^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply Build_IsNormalSubgroup&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Inner automorphisms of a group [G] restrict to automorphisms of normal subgroups. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkf9"><span class="kn">Definition</span> <span class="nf">grp_iso_normal_conj</span> {<span class="nv">G</span> : Group} (<span class="nv">N</span> : Subgroup G)
  `{!IsNormalSubgroup N} (x : G)
  : subgroup_group N $&lt;~&gt; subgroup_group N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N $&lt;~&gt; N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkfa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N $&lt;~&gt; N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkfb">snapply grp_iso_subgroup_group.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $&lt;~&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chkfc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chkfc"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x0</span> : G, N x0 &lt;-&gt; N (<span class="nl">?e</span> x0)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkfd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $&lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (grp_iso_conj x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkfe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x0</span> : G, N x0 &lt;-&gt; N (grp_iso_conj x x0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chkff"><span class="nb">intros</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N y &lt;-&gt; N (grp_iso_conj x y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">rapply isnormal_conj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Left and right cosets are equivalent in normal subgroups. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_in_cosetL_in_cosetR_normalsubgroup</span> {<span class="nv">G</span> : Group}
  (<span class="nv">N</span> : NormalSubgroup G) (<span class="nv">x</span> <span class="nv">y</span> : G)
  : in_cosetL N x y &lt;~&gt; in_cosetR N x y
  := equiv_in_cosetR_symm _ _ oE equiv_symmetric_in_normalsubgroup _ _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Inverses are then respected *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk100"><span class="kn">Definition</span> <span class="nf">in_cosetL_inverse</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : NormalSubgroup G} (<span class="nv">x</span> <span class="nv">y</span> : G)
  : in_cosetL N x^ y^ &lt;~&gt; in_cosetL N x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x^ y^ &lt;~&gt; in_cosetL N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk101"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x^ y^ &lt;~&gt; in_cosetL N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk102"><span class="nb">refine</span> (_ oE equiv_in_cosetL_in_cosetR_normalsubgroup _ _ _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x^ * (y^)^) &lt;~&gt; N (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> inverse_involutive.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk103"><span class="kn">Definition</span> <span class="nf">in_cosetR_inverse</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : NormalSubgroup G} (<span class="nv">x</span> <span class="nv">y</span> : G)
  : in_cosetR N x^ y^ &lt;~&gt; in_cosetR N x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x^ y^ &lt;~&gt; in_cosetR N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk104"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x^ y^ &lt;~&gt; in_cosetR N x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk105"><span class="nb">refine</span> (_ oE equiv_in_cosetL_in_cosetR_normalsubgroup _ _ _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * ((y^)^)^) &lt;~&gt; N (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> grp_inv_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** This lets us prove that left and right coset relations are congruences. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk106"><span class="kn">Definition</span> <span class="nf">in_cosetL_cong</span> {<span class="nv">G</span> : Group} {<span class="nv">N</span> : NormalSubgroup G}
  (<span class="nv">x</span> <span class="nv">x&#39;</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : G)
  : in_cosetL N x y -&gt; in_cosetL N x&#39; y&#39; -&gt; in_cosetL N (x * x&#39;) (y * y&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x y -&gt;
in_cosetL N x&#39; y&#39; -&gt; in_cosetL N (x * x&#39;) (y * y&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk107"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetL N x y -&gt;
in_cosetL N x&#39; y&#39; -&gt; in_cosetL N (x * x&#39;) (y * y&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk108"><span class="nb">cbn</span>; <span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N ((x * x&#39;)^ * (y * y&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** rewrite goal before applying subgroup_op *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk109"><span class="nb">rewrite</span> inverse_sg_op, &lt;- simple_associativity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x&#39;^ * (x^ * (y * y&#39;)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10a"><span class="nb">apply</span> isnormal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x^ * (y * y&#39;) * x&#39;^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10b"><span class="nb">rewrite</span> simple_associativity, &lt;- simple_associativity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x^ * y * (y&#39; * x&#39;^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10c"><span class="nb">apply</span> subgroup_in_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x^ * y)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk10d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk10d"><hr></label><div class="goal-conclusion">N (y&#39; * x&#39;^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10e"><span class="mi">1</span>: <span class="bp">exact</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y&#39; * x&#39;^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk10f"><span class="nb">apply</span> isnormal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x^ * y)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39;^ * y&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x&#39;^ * y&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk110"><span class="kn">Definition</span> <span class="nf">in_cosetR_cong</span>  {<span class="nv">G</span> : Group} {<span class="nv">N</span> : NormalSubgroup G}
  (<span class="nv">x</span> <span class="nv">x&#39;</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : G)
  : in_cosetR N x y -&gt; in_cosetR N x&#39; y&#39; -&gt; in_cosetR N (x * x&#39;) (y * y&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x y -&gt;
in_cosetR N x&#39; y&#39; -&gt; in_cosetR N (x * x&#39;) (y * y&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk111"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">in_cosetR N x y -&gt;
in_cosetR N x&#39; y&#39; -&gt; in_cosetR N (x * x&#39;) (y * y&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk112"><span class="nb">cbn</span>; <span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * x&#39; * (y * y&#39;)^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** rewrite goal before applying subgroup_op *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk113"><span class="nb">rewrite</span> inverse_sg_op, simple_associativity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * x&#39; * y&#39;^ * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk114"><span class="nb">apply</span> isnormal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * (x * x&#39; * y&#39;^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk115"><span class="nb">rewrite</span> &lt;- simple_associativity, simple_associativity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * x * (x&#39; * y&#39;^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk116"><span class="nb">apply</span> subgroup_in_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk117"><hr></label><div class="goal-conclusion">N (x&#39; * y&#39;^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk118"><span class="mi">2</span>: <span class="bp">exact</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (y^ * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk119"><span class="nb">apply</span> isnormal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>NormalSubgroup G</span></span></span><br><span><var>x, x', y, y'</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>N (x * y^)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>N (x&#39; * y&#39;^)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Trivial subgroup *)</span>

<span class="sd">(** The trivial subgroup of a group [G]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11a"><span class="kn">Definition</span> <span class="nf">trivial_subgroup</span> <span class="nv">G</span> : Subgroup G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11c">rapply (Build_Subgroup&#39; (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x = <span class="mi">1</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk11d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk11d"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, x = <span class="mi">1</span> -&gt; y = <span class="mi">1</span> -&gt; x * y^ = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11e"><span class="mi">1</span>: <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, x = <span class="mi">1</span> -&gt; y = <span class="mi">1</span> -&gt; x * y^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk11f"><span class="nb">intros</span> x y p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = <span class="mi">1</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x * y^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk120"><span class="nb">rewrite</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = <span class="mi">1</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> * <span class="mi">1</span>^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk121"><span class="nb">rewrite</span> left_identity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = <span class="mi">1</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span>^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> grp_inv_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trivial subgroup is always included in any subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk122"><span class="kn">Definition</span> <span class="nf">trivial_subgroup_rec</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : <span class="kr">forall</span> <span class="nv">x</span>, trivial_subgroup G x -&gt; H x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, trivial_subgroup G x -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk123"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, trivial_subgroup G x -&gt; H x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk124">napply paths_ind_r; <span class="nb">cbn</span> beta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trivial subgroup is a normal subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk125"><span class="kn">Instance</span> <span class="nf">isnormal_trivial_subgroup</span> {<span class="nv">G</span> : Group}
  : IsNormalSubgroup (trivial_subgroup G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (trivial_subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk126"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (trivial_subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk127"><span class="nb">intros</span> x y p; <span class="nb">cbn</span> <span class="kr">in</span> p |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x * y = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y * x = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk128"><span class="nb">apply</span> grp_moveL_1V <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y * x = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> grp_moveL_V1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The property of being the trivial subgroup. Note that any group can be automatically coerced to its maximal subgroup, so it makes sense for this predicate to be applied to groups in general. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsTrivialGroup</span>@{i} {G : Group@{i}} (H : Subgroup@{i i} G) :=
  istrivialgroup : <span class="kr">forall</span> <span class="nv">x</span>, H x -&gt; trivial_subgroup G x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ishprop_istrivialgroup</span> `{F : Funext} {G : Group} (H : Subgroup G)
  : IsHProp (IsTrivialGroup H)
  := istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">istrivial_trivial_subgroup</span> {<span class="nv">G</span> : Group}
  : IsTrivialGroup (trivial_subgroup G)
  := <span class="kr">fun</span> <span class="nv">x</span> =&gt; idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Trivial groups are isomorphic to the trivial group. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk129"><span class="kn">Definition</span> <span class="nf">istrivial_iff_grp_iso_trivial</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : IsTrivialGroup H &lt;-&gt; (subgroup_group H $&lt;~&gt; grp_trivial).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup H &lt;-&gt; H $&lt;~&gt; grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup H &lt;-&gt; H $&lt;~&gt; grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup H -&gt; H $&lt;~&gt; grp_trivial</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk12c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk12c"><hr></label><div class="goal-conclusion">H $&lt;~&gt; grp_trivial -&gt; IsTrivialGroup H</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup H -&gt; H $&lt;~&gt; grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12e"><span class="nb">intros</span> triv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H $&lt;~&gt; grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk12f">snapply cate_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H $-&gt; grp_trivial</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk130" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk130"><hr></label><div class="goal-conclusion">grp_trivial $-&gt; H</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk131" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk131"><hr></label><div class="goal-conclusion"><span class="nl">?f</span> $o <span class="nl">?g</span> $== Id grp_trivial</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk132" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk132"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> $o <span class="nl">?f</span> $== Id H</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk133"><span class="mi">1</span>,<span class="mi">2</span>: <span class="bp">exact</span> grp_homo_const.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">grp_homo_const $o grp_homo_const $== Id grp_trivial</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk134" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk134"><hr></label><div class="goal-conclusion">grp_homo_const $o grp_homo_const $== Id H</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk135">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">grp_homo_const $o grp_homo_const $== Id grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">intros</span> [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk136">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">grp_homo_const $o grp_homo_const $== Id H</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk137"><span class="nb">intros</span> [x Hx]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span>; issubgroup_in_unit) = (x; Hx)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk138"><span class="nb">apply</span> path_sigma_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span>; issubgroup_in_unit).<span class="mi">1</span> = (x; Hx).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk139"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; Hx).<span class="mi">1</span> = (<span class="mi">1</span>; issubgroup_in_unit).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> triv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H $&lt;~&gt; grp_trivial -&gt; IsTrivialGroup H</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13b"><span class="nb">intros</span> e x Hx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trivial_subgroup G x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13c"><span class="nb">change</span> ((x; Hx).<span class="mi">1</span> = (<span class="mi">1</span>; idpath).<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; Hx).<span class="mi">1</span> = (<span class="mi">1</span>; <span class="mi">1</span>%path).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13d">snapply (pr1_path (u:=(_;_)) (v:=(_;_))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk13e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk13e"><hr></label><div class="goal-conclusion">(x; Hx) = (<span class="mi">1</span>; <span class="nl">?proj2</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk13f"><span class="mi">1</span>: <span class="nb">apply</span> subgroup_in_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; Hx) = (<span class="mi">1</span>; subgroup_in_unit H)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk140">rhs_V <span class="bp">exact</span> (grp_homo_unit e^-<span class="mi">1</span>$).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; Hx) = e^-<span class="mi">1</span>$ <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk141"><span class="nb">apply</span> moveL_equiv_V.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>H $&lt;~&gt; grp_trivial</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e (x; Hx) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** All trivial subgroups are isomorphic as groups. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk142"><span class="kn">Definition</span> <span class="nf">grp_iso_trivial_subgroup</span> (<span class="nv">G</span> <span class="nv">H</span> : Group)
  : subgroup_group (trivial_subgroup G)
    $&lt;~&gt; subgroup_group (trivial_subgroup H).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trivial_subgroup G $&lt;~&gt; trivial_subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk143"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trivial_subgroup G $&lt;~&gt; trivial_subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk144">snrefine (_^-<span class="mi">1</span>$ $oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Group</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk145" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk145"><hr></label><div class="goal-conclusion">trivial_subgroup H $&lt;~&gt; <span class="nl">?b</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk146" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk146"><hr></label><div class="goal-conclusion">trivial_subgroup G $&lt;~&gt; <span class="nl">?b</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk147"><span class="mi">1</span>: <span class="bp">exact</span> grp_trivial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trivial_subgroup H $&lt;~&gt; grp_trivial</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk148" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk148"><hr></label><div class="goal-conclusion">trivial_subgroup G $&lt;~&gt; grp_trivial</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="mi">1</span>,<span class="mi">2</span>: <span class="nb">apply</span> istrivial_iff_grp_iso_trivial; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk149"><span class="kn">Definition</span> <span class="nf">istrivial_grp_iso</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">J</span> : Subgroup G) (<span class="nv">K</span> : Subgroup H)
  (<span class="nv">e</span> : subgroup_group J $&lt;~&gt; subgroup_group K)
  : IsTrivialGroup J -&gt; IsTrivialGroup K.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup J -&gt; IsTrivialGroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup J -&gt; IsTrivialGroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14b"><span class="nb">intros</span> triv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; K</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup J</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14c"><span class="nb">apply</span> istrivial_iff_grp_iso_trivial <span class="kr">in</span> triv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; K</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; grp_trivial</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup K</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14d"><span class="nb">apply</span> istrivial_iff_grp_iso_trivial.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; K</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>J $&lt;~&gt; grp_trivial</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K $&lt;~&gt; grp_trivial</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (triv $oE e^-<span class="mi">1</span>$).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Maximal Subgroups *)</span>

<span class="sd">(** Every group is a (maximal) subgroup of itself. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14e"><span class="kn">Definition</span> <span class="nf">maximal_subgroup</span> <span class="nv">G</span> : Subgroup G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk14f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk150">rapply (Build_Subgroup G (<span class="kr">fun</span> <span class="nv">x</span> =&gt; Unit)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup (<span class="kr">fun</span> <span class="nv">_</span> : G =&gt; Unit)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We wish to coerce a group to its maximal subgroup. However, if we don&#39;t explicitly print [maximal_subgroup] things can get confusing, so we mark it as a coercion to be printed. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">maximal_subgroup</span> : Group &gt;-&gt; Subgroup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Add Printing Coercion</span> maximal_subgroup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The group associated to the maximal subgroup is the original group. Note that this equivalence does not characterize the maximal subgroup, as a proper subgroup can be isomorphic to the whole group. For example, the even integers are isomorphic to the integers. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk151"><span class="kn">Definition</span> <span class="nf">grp_iso_subgroup_group_maximal</span> (<span class="nv">G</span> : Group)
  : subgroup_group (maximal_subgroup G) $&lt;~&gt; G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">maximal_subgroup G $&lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk152"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">maximal_subgroup G $&lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk153">snapply Build_GroupIsomorphism&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">maximal_subgroup G &lt;~&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk154" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk154"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?f</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk155">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">maximal_subgroup G &lt;~&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">rapply equiv_sigma_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk156">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving
  (equiv_sigma_contr (maximal_subgroup G))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">hnf</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The maximal subgroup (the group itself) is a normal subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk157"><span class="kn">Instance</span> <span class="nf">isnormal_maximal_subgroup</span> {<span class="nv">G</span> : Group}
  : IsNormalSubgroup (maximal_subgroup G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (maximal_subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk158"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (maximal_subgroup G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y p; <span class="bp">exact</span> tt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The property of being a maximal subgroup of a group [G]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsMaximalSubgroup</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G) :=
  ismaximalsubgroup : <span class="kr">forall</span> (<span class="nv">x</span> : G), H x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ishprop_ismaximalsubgroup</span> `{Funext}
  {G : Group} (H : Subgroup G)
  : IsHProp (IsMaximalSubgroup H)
  := istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ismaximalsubgroup_maximalsubgroup</span> {<span class="nv">G</span> : Group}
  : IsMaximalSubgroup (maximal_subgroup G)
  := <span class="kr">fun</span> <span class="nv">g</span> =&gt; tt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Subgroups in opposite group *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk159"><span class="kn">Instance</span> <span class="nf">issubgroup_grp_op</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : G -&gt; <span class="kt">Type</span>)
  : IsSubgroup H -&gt; IsSubgroup (G:=grp_op G) H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H -&gt; IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk15a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H -&gt; IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk15b"><span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk15c">snapply Build_IsSubgroup&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : grp_op G, IsHProp (H x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk15d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk15d"><hr></label><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk15e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk15e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : grp_op G, H x -&gt; H y -&gt; H (x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk15f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : grp_op G, IsHProp (H x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk160">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">cbn</span>; <span class="bp">exact</span> issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk161">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : grp_op G, H x -&gt; H y -&gt; H (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk162"><span class="nb">intros</span> x y Hx Hy; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br><span><var>Hx</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>Hy</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (y^ * x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> issubgroup_in_inv_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Note that [grp_op] is definitionally involutive, so the next result also gives us a map [Subgroup (grp_op G) -&gt; Subgroup G]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_grp_op</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : Subgroup (grp_op G)
  := Build_Subgroup (grp_op G) H _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk163"><span class="kn">Instance</span> <span class="nf">isnormal_subgroup_grp_op</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> : Subgroup G)
  : IsNormalSubgroup H -&gt; IsNormalSubgroup (subgroup_grp_op H).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup H -&gt;
IsNormalSubgroup (subgroup_grp_op H)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk164"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup H -&gt;
IsNormalSubgroup (subgroup_grp_op H)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk165"><span class="nb">intros</span> n x y; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H (y * x) -&gt; H (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> isnormal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">normalsubgroup_grp_op</span> {<span class="nv">G</span> : Group}
  : NormalSubgroup G -&gt; NormalSubgroup (grp_op G)
  := <span class="kr">fun</span> <span class="nv">N</span> =&gt; Build_NormalSubgroup (grp_op G) (subgroup_grp_op N) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Preimage subgroup *)</span>

<span class="sd">(** The preimage of a subgroup under a group homomorphism is a subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk166"><span class="kn">Instance</span> <span class="nf">issubgroup_preimage</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">S</span> : H -&gt; <span class="kt">Type</span>)
  : IsSubgroup S -&gt; IsSubgroup (S o f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup S -&gt; IsSubgroup (S o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk167"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup S -&gt; IsSubgroup (S o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk168"><span class="nb">intros</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup (S o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk169">snapply Build_IsSubgroup&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp ((<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk16a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk16a"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; S (f x)) <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk16b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk16b"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) x -&gt;
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) y -&gt;
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) (x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk16c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp ((<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">hnf</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk16d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; S (f x)) <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk16e">nrefine (transport S (grp_homo_unit f)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> issubgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk16f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) x -&gt;
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) y -&gt;
(<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; S (f x0)) (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk170"><span class="nb">hnf</span>; <span class="nb">intros</span> x y Sfx Sfy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Sfx</var><span class="hyp-type"><b>: </b><span>S (f x)</span></span></span><br><span><var>Sfy</var><span class="hyp-type"><b>: </b><span>S (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f (x * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk171">nrefine (transport S (grp_homo_op f _ _)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Sfx</var><span class="hyp-type"><b>: </b><span>S (f x)</span></span></span><br><span><var>Sfy</var><span class="hyp-type"><b>: </b><span>S (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f x * f y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk172">rapply issubgroup_in_op; <span class="kp">only</span> <span class="mi">1</span>: <span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Sfx</var><span class="hyp-type"><b>: </b><span>S (f x)</span></span></span><br><span><var>Sfy</var><span class="hyp-type"><b>: </b><span>S (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk173">nrefine (transport S (grp_homo_inv f _)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsSubgroup S</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Sfx</var><span class="hyp-type"><b>: </b><span>S (f x)</span></span></span><br><span><var>Sfy</var><span class="hyp-type"><b>: </b><span>S (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (f y)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> issubgroup_in_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_preimage</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">S</span> : Subgroup H)
  : Subgroup G
  := Build_Subgroup G (S o f) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The preimage of a normal subgroup is again normal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk174"><span class="kn">Instance</span> <span class="nf">isnormal_subgroup_preimage</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  (<span class="nv">N</span> : Subgroup H) `{!IsNormalSubgroup N}
  : IsNormalSubgroup (subgroup_preimage f N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_preimage f N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk175"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_preimage f N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk176"><span class="nb">intros</span> x y Nfxy; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Nfxy</var><span class="hyp-type"><b>: </b><span>subgroup_preimage f N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (f (y * x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk177">nrefine (transport N (grp_homo_op _ _ _)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Nfxy</var><span class="hyp-type"><b>: </b><span>subgroup_preimage f N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (f y * f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk178"><span class="nb">apply</span> isnormal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup N</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Nfxy</var><span class="hyp-type"><b>: </b><span>subgroup_preimage f N (x * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">N (f x * f y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (transport N (grp_homo_op _ _ _) Nfxy).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Subgroup intersection *)</span>

<span class="sd">(** Intersection of two subgroups *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk179"><span class="kn">Definition</span> <span class="nf">subgroup_intersection</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G) : Subgroup G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk17a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk17b">snapply Build_Subgroup&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G -&gt; <span class="kt">Type</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk17c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk17c"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, IsHProp (<span class="nl">?H</span> x)</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk17d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk17d"><hr></label><div class="goal-conclusion"><span class="nl">?H</span> <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk17e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk17e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G, <span class="nl">?H</span> x -&gt; <span class="nl">?H</span> y -&gt; <span class="nl">?H</span> (x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk17f"><span class="mi">1</span>: <span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">g</span> =&gt; H g /\ K g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
IsHProp ((<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk180" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk180"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk181" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk181"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) x -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) y -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) (x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk182"><span class="mi">1</span>: <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk183" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk183"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) x -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) y -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) (x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk184"><span class="mi">1</span>: <span class="nb">split</span>; <span class="nb">apply</span> subgroup_in_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) x -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) y -&gt;
(<span class="kr">fun</span> <span class="nv">g</span> : G =&gt; (H g * K g)%type) (x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk185"><span class="nb">intros</span> x y [] [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>fst</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br><span><var>snd</var><span class="hyp-type"><b>: </b><span>K x</span></span></span><br><span><var>fst0</var><span class="hyp-type"><b>: </b><span>H y</span></span></span><br><span><var>snd0</var><span class="hyp-type"><b>: </b><span>K y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(H (sg_op x y^) * K (sg_op x y^))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">by</span> <span class="nb">apply</span> subgroup_in_op_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Simple groups *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsSimpleGroup</span> (<span class="nv">G</span> : Group)
  := is_simple_group : <span class="kr">forall</span> (<span class="nv">N</span> : Subgroup G) `{IsNormalSubgroup G N},
    IsTrivialGroup N + IsMaximalSubgroup N.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** The subgroup generated by a subset *)</span>

<span class="sd">(** Underlying type family of a subgroup generated by subset *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">subgroup_generated_type</span> {<span class="nv">G</span> : Group} (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) : G -&gt; <span class="kt">Type</span> :=
<span class="sd">(** The subgroup should contain all elements of the original family. *)</span>
| sgt_in (g : G) : X g -&gt; subgroup_generated_type X g
<span class="sd">(** It should contain the unit. *)</span>
| sgt_unit : subgroup_generated_type X mon_unit
<span class="sd">(** Finally, it should be closed under inverses and operation. *)</span>
| sgt_op (g h : G)
  : subgroup_generated_type X g
  -&gt; subgroup_generated_type X h
  -&gt; subgroup_generated_type X (g * h^)
.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> sgt_in {G X g}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> sgt_unit {G X}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> sgt_op {G X g h}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Note that [subgroup_generated_type] will not automatically land in [HProp]. For example, if [X] already &quot;contains&quot; the unit of the group, then there are at least two different inhabitants of this family at the unit (given by [sgt_unit] and [sgt_in group_unit _]). Therefore, we propositionally truncate in [subgroup_generated] below. *)</span>

<span class="sd">(** Subgroups are closed under inverses. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk186"><span class="kn">Definition</span> <span class="nf">sgt_inv</span> {<span class="nv">G</span> : Group} {<span class="nv">X</span>} {<span class="nv">g</span> : G}
  : subgroup_generated_type X g -&gt; subgroup_generated_type X g^.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g -&gt;
subgroup_generated_type X g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk187"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g -&gt;
subgroup_generated_type X g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk188"><span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk189"><span class="nb">rewrite</span> &lt;- left_identity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X (<span class="mi">1</span> * g^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (sgt_op sgt_unit p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18a"><span class="kn">Definition</span> <span class="nf">sgt_inv&#39;</span> {<span class="nv">G</span> : Group} {<span class="nv">X</span>} {<span class="nv">g</span> : G}
  : subgroup_generated_type X g^ -&gt; subgroup_generated_type X g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g^ -&gt;
subgroup_generated_type X g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g^ -&gt;
subgroup_generated_type X g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18c"><span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18d"><span class="nb">rewrite</span> &lt;- grp_inv_inv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g^</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X (g^)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> sgt_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18e"><span class="kn">Definition</span> <span class="nf">sgt_op&#39;</span> {<span class="nv">G</span> : Group} {<span class="nv">X</span>} {<span class="nv">g</span> <span class="nv">h</span> : G}
  : subgroup_generated_type X g
    -&gt; subgroup_generated_type X h
    -&gt; subgroup_generated_type X (g * h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g -&gt;
subgroup_generated_type X h -&gt;
subgroup_generated_type X (g * h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk18f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X g -&gt;
subgroup_generated_type X h -&gt;
subgroup_generated_type X (g * h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk190"><span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X (g * h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk191"><span class="nb">rewrite</span> &lt;- (inverse_involutive h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated_type X (g * (h^)^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (sgt_op p (sgt_inv q)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The subgroup generated by a subset *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk192"><span class="kn">Definition</span> <span class="nf">subgroup_generated</span> {<span class="nv">G</span> : Group} (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) : Subgroup G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk193"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk194"><span class="nb">refine</span> (Build_Subgroup&#39; (merely o subgroup_generated_type X)
            (tr sgt_unit) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
merely (subgroup_generated_type X x) -&gt;
merely (subgroup_generated_type X y) -&gt;
merely (subgroup_generated_type X (x * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk195"><span class="nb">intros</span> x y p q; strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely (subgroup_generated_type X (x * y^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (tr (sgt_op p q)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The inclusion of generators into the generated subgroup. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_generated_gen_incl</span> {<span class="nv">G</span> : Group} {<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>} (<span class="nv">g</span> : G) (<span class="nv">H</span> : X g)
  : subgroup_generated X
  := (g; tr (sgt_in H)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The generated subgroup is the smallest subgroup containing the generating set. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk196"><span class="kn">Definition</span> <span class="nf">subgroup_generated_rec</span> {<span class="nv">G</span> : Group} (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">S</span> : Subgroup G)
  (<span class="nv">i</span> : <span class="kr">forall</span> <span class="nv">g</span>, X g -&gt; S g)
  : <span class="kr">forall</span> <span class="nv">g</span>, subgroup_generated X g -&gt; S g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G, subgroup_generated X g -&gt; S g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk197"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G, subgroup_generated X g -&gt; S g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk198"><span class="nb">intros</span> g; rapply Trunc_rec; <span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk199"><span class="nb">induction</span> p <span class="kr">as</span> [g Xg | | g h p1 IHp1 p2 IHp2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xg</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk19a"><hr></label><div class="goal-conclusion">S <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk19b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p1</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>p2</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br><span><var>IHp1</var><span class="hyp-type"><b>: </b><span>S g</span></span></span><br><span><var>IHp2</var><span class="hyp-type"><b>: </b><span>S h</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk19b"><hr></label><div class="goal-conclusion">S (g * h^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk19c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xg</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> i.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk19d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> subgroup_in_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk19e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; S g</span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p1</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>p2</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br><span><var>IHp1</var><span class="hyp-type"><b>: </b><span>S g</span></span></span><br><span><var>IHp2</var><span class="hyp-type"><b>: </b><span>S h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (g * h^)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> subgroup_in_op_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If [f : G $-&gt; H] is a group homomorphism and [X] and [Y] are subsets of [G] and [H] such that [f] maps [X] into [Y], then [f] sends the subgroup generated by [X] into the subgroup generated by [Y]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk19f"><span class="kn">Definition</span> <span class="nf">functor_subgroup_generated</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">Y</span> : H -&gt; <span class="kt">Type</span>)
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">preserves</span> : <span class="kr">forall</span> <span class="nv">g</span>, X g -&gt; Y (f g))
  : <span class="kr">forall</span> <span class="nv">g</span>, subgroup_generated X g -&gt; subgroup_generated Y (f g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g -&gt; subgroup_generated Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g -&gt; subgroup_generated Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a1"><span class="nb">change</span> (subgroup_generated Y (f <span class="nl">?g</span>))
    <span class="kr">with</span> (subgroup_preimage f (subgroup_generated Y) g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g -&gt;
subgroup_preimage f (subgroup_generated Y) g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a2"><span class="nb">apply</span> subgroup_generated_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
X g -&gt; subgroup_preimage f (subgroup_generated Y) g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a3"><span class="nb">intros</span> g p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_preimage f (subgroup_generated Y) g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a4"><span class="nb">apply</span> tr, sgt_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preserves.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a5"><span class="kn">Definition</span> <span class="nf">subgroup_eq_functor_subgroup_generated</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">Y</span> : H -&gt; <span class="kt">Type</span>) (<span class="nv">f</span> : G $&lt;~&gt; H) (<span class="nv">preserves</span> : <span class="kr">forall</span> <span class="nv">g</span>, X g &lt;-&gt; Y (f g))
  : <span class="kr">forall</span> <span class="nv">g</span>, subgroup_generated X g &lt;-&gt; subgroup_generated Y (f g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g &lt;-&gt; subgroup_generated Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g &lt;-&gt; subgroup_generated Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a7"><span class="nb">intros</span> x; <span class="nb">split</span>; <span class="nb">revert</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_generated X x -&gt; subgroup_generated Y (f x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1a8"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_generated Y (f x) -&gt; subgroup_generated X x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1a9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_generated X x -&gt; subgroup_generated Y (f x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1aa"><span class="nb">apply</span> functor_subgroup_generated.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G, X g -&gt; Y (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> preserves.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ab">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_generated Y (f x) -&gt; subgroup_generated X x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ac">equiv_intro f^-<span class="mi">1</span>$ x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated Y (f (f^-<span class="mi">1</span>$ x)) -&gt;
subgroup_generated X (f^-<span class="mi">1</span>$ x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ad"><span class="nb">rewrite</span> eisretr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated Y x -&gt;
subgroup_generated X (f^-<span class="mi">1</span>$ x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ae"><span class="nb">apply</span> functor_subgroup_generated; <span class="nb">clear</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : H, Y g -&gt; X (f^-<span class="mi">1</span>$ g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1af">equiv_intro f x; <span class="nb">intros</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Y (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X (f^-<span class="mi">1</span>$ (f x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b0"><span class="nb">simpl</span>; <span class="nb">rewrite</span> (eissect f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>H -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y (f g)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Y (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> preserves.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A similar result is true if we replace one group by its opposite, i.e. if [f] is an anti-homomorphism.  For simplicity, we state this only for the case in which [f] is the identity isomorphism.  It&#39;s also useful in the special case where [X] and [Y] are the same. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b1"><span class="kn">Definition</span> <span class="nf">subgroup_eq_subgroup_generated_op</span> {<span class="nv">G</span> : Group}
  (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">Y</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">preserves</span> : <span class="kr">forall</span> <span class="nv">g</span>, X g &lt;-&gt; Y g)
  : <span class="kr">forall</span> <span class="nv">g</span>, subgroup_generated X g &lt;-&gt; subgroup_generated (G:=grp_op G) Y g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g &lt;-&gt; subgroup_generated Y g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g &lt;-&gt; subgroup_generated Y g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b3"><span class="nb">intro</span> g; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X g -&gt; subgroup_generated Y g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1b4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1b4"><hr></label><div class="goal-conclusion">subgroup_generated Y g -&gt; subgroup_generated X g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b5"><span class="mi">1</span>: <span class="nb">change</span> (subgroup_generated X g -&gt; subgroup_grp_op (subgroup_generated (G:=grp_op G) Y) g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X g -&gt;
subgroup_grp_op (subgroup_generated Y) g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1b6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1b6"><hr></label><div class="goal-conclusion">subgroup_generated Y g -&gt; subgroup_generated X g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b7"><span class="mi">2</span>: <span class="nb">change</span> (subgroup_generated (G:=grp_op G) Y g -&gt; subgroup_grp_op (subgroup_generated X) g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X g -&gt;
subgroup_grp_op (subgroup_generated Y) g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1b8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1b8"><hr></label><div class="goal-conclusion">subgroup_generated Y g -&gt;
subgroup_grp_op (subgroup_generated X) g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1b9"><span class="kp">all</span>: <span class="nb">apply</span> subgroup_generated_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
X g -&gt; subgroup_grp_op (subgroup_generated Y) g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1ba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1ba"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : grp_op G,
Y g -&gt; subgroup_grp_op (subgroup_generated X) g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1bb"><span class="kp">all</span>: <span class="nb">intros</span> x Xx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g, x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xx</var><span class="hyp-type"><b>: </b><span>X x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_grp_op (subgroup_generated Y) x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1bc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br><span><var>Xx</var><span class="hyp-type"><b>: </b><span>Y x</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1bc"><hr></label><div class="goal-conclusion">subgroup_grp_op (subgroup_generated X) x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1bd"><span class="kp">all</span>: <span class="nb">apply</span> (tr o sgt_in).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g, x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xx</var><span class="hyp-type"><b>: </b><span>X x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1be" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>preserves</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, X g &lt;-&gt; Y g</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br><span><var>Xx</var><span class="hyp-type"><b>: </b><span>Y x</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1be"><hr></label><div class="goal-conclusion">X x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="bp">by</span> <span class="nb">apply</span> (preserves x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Product of subgroups *)</span>

<span class="sd">(** The product of two subgroups. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_product</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G) : Subgroup G
  := subgroup_generated (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (H x + K x)%type).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The induction principle for the product. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1bf"><span class="kn">Definition</span> <span class="nf">subgroup_product_ind</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G)
  (<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span>, subgroup_product H K x -&gt; <span class="kt">Type</span>)
  (<span class="nv">P_H_in</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, P x (tr (sgt_in (inl y))))
  (<span class="nv">P_K_in</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, P x (tr (sgt_in (inr y))))
  (<span class="nv">P_unit</span> : P mon_unit (tr sgt_unit))
  (<span class="nv">P_op</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">h</span> <span class="nv">k</span>, P x (tr h) -&gt; P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k)))
  `{<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, IsHProp (P x y)}
  : <span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">p</span> : subgroup_product H K x), P x p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">p</span> : subgroup_product H K x), P x p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">p</span> : subgroup_product H K x), P x p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c1"><span class="nb">intros</span> x p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_product H K x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c2">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type
  (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (H x + K x)%type) x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c3"><span class="nb">induction</span> p <span class="kr">as</span> [x s | | x y h IHh k IHk].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>(H x + K x)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr (sgt_in s))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1c4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1c4"><hr></label><div class="goal-conclusion">P <span class="mi">1</span> (tr sgt_unit)</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1c5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type
  (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (H x + K x)%type) x</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type
  (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (H x + K x)%type) y</span></span></span><br><span><var>IHh</var><span class="hyp-type"><b>: </b><span>P x (tr h)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>P y (tr k)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1c5"><hr></label><div class="goal-conclusion">P (x * y^) (tr (sgt_op h k))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>(H x + K x)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr (sgt_in s))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c7"><span class="nb">destruct</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr (sgt_in (inl s)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1c8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>K x</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1c8"><hr></label><div class="goal-conclusion">P x (tr (sgt_in (inr s)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1c9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>H x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr (sgt_in (inl s)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> P_H_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ca">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>K x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P x (tr (sgt_in (inr s)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> P_K_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1cb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P <span class="mi">1</span> (tr sgt_unit)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> P_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1cc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, subgroup_product H K x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P_H_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : H x),
P x (tr (sgt_in (inl y)))</span></span></span><br><span><var>P_K_in</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : K x),
P x (tr (sgt_in (inr y)))</span></span></span><br><span><var>P_unit</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span> (tr sgt_unit)</span></span></span><br><span><var>P_op</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : G)
(<span class="nv">h</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) x)
(<span class="nv">k</span> : subgroup_generated_type
       (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; (H x0 + K x0)%type) y),
P x (tr h) -&gt;
P y (tr k) -&gt; P (x * - y) (tr (sgt_op h k))</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : G) (<span class="nv">y</span> : subgroup_product H K x),
IsHProp (P x y)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type
  (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (H x + K x)%type) x</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type
  (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (H x + K x)%type) y</span></span></span><br><span><var>IHh</var><span class="hyp-type"><b>: </b><span>P x (tr h)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>P y (tr k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (x * y^) (tr (sgt_op h k))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> P_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_product_incl_l</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G)
  : <span class="kr">forall</span> <span class="nv">x</span>, H x -&gt; subgroup_product H K x
  := <span class="kr">fun</span> <span class="nv">x</span> =&gt; tr o sgt_in o inl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_product_incl_r</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G)
  : <span class="kr">forall</span> <span class="nv">x</span>, K x -&gt; subgroup_product H K x
  := <span class="kr">fun</span> <span class="nv">x</span> =&gt; tr o sgt_in o inr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A product of normal subgroups is normal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1cd"><span class="kn">Instance</span> <span class="nf">isnormal_subgroup_product</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G)
  `{!IsNormalSubgroup H, !IsNormalSubgroup K}
  : IsNormalSubgroup (subgroup_product H K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_product H K)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ce"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_product H K)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1cf">snapply Build_IsNormalSubgroup&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : G,
subgroup_product H K x -&gt;
subgroup_product H K (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d0"><span class="nb">intros</span> x y; <span class="nb">revert</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_product H K x -&gt;
subgroup_product H K (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d1">napply (functor_subgroup_generated _ _ (grp_conj y)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
H g + K g -&gt; H (grp_conj y g) + K (grp_conj y g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d2"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup H</span></span></span><br><span><var>IsNormalSubgroup1</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup K</span></span></span><br><span><var>y, x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">H x + K x -&gt; H (grp_conj y x) + K (grp_conj y x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> functor_sum; rapply isnormal_conj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">normalsubgroup_product</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : NormalSubgroup G)
  : NormalSubgroup G
  := Build_NormalSubgroup G (subgroup_product H K) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d3"><span class="kn">Definition</span> <span class="nf">functor_subgroup_product</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  {<span class="nv">J</span> <span class="nv">K</span> : Subgroup G} {<span class="nv">L</span> <span class="nv">M</span> : Subgroup H}
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">l</span> : <span class="kr">forall</span> <span class="nv">x</span>, J x -&gt; L (f x)) (<span class="nv">r</span> : <span class="kr">forall</span> <span class="nv">x</span>, K x -&gt; M (f x))
  : <span class="kr">forall</span> <span class="nv">x</span>, subgroup_product J K x -&gt; subgroup_product L M (f x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x -&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_product J K x -&gt; subgroup_product L M (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x -&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_product J K x -&gt; subgroup_product L M (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d5">snapply functor_subgroup_generated.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x -&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
(<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (J x + K x)%type) g -&gt;
(<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; (L x + M x)%type) (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; functor_sum (l x) (r x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d6"><span class="kn">Definition</span> <span class="nf">subgroup_eq_functor_subgroup_product</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  {<span class="nv">J</span> <span class="nv">K</span> : Subgroup G} {<span class="nv">L</span> <span class="nv">M</span> : Subgroup H}
  (<span class="nv">f</span> : G $&lt;~&gt; H) (<span class="nv">l</span> : <span class="kr">forall</span> <span class="nv">x</span>, J x &lt;-&gt; L (f x)) (<span class="nv">r</span> : <span class="kr">forall</span> <span class="nv">x</span>, K x &lt;-&gt; M (f x))
  : <span class="kr">forall</span> <span class="nv">x</span>, subgroup_product J K x &lt;-&gt; subgroup_product L M (f x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x &lt;-&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_product J K x &lt;-&gt; subgroup_product L M (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x &lt;-&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
subgroup_product J K x &lt;-&gt; subgroup_product L M (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d8">snapply subgroup_eq_functor_subgroup_generated.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>J, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>L, M</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $&lt;~&gt; H</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x &lt;-&gt; L (f x)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, K x &lt;-&gt; M (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
(<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (J x + K x)%type) g &lt;-&gt;
(<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; (L x + M x)%type) (f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; iff_functor_sum (l x) (r x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1d9"><span class="kn">Definition</span> <span class="nf">subgroup_eq_product_grp_op</span> {<span class="nv">G</span> : Group} (<span class="nv">H</span> <span class="nv">K</span> : Subgroup G)
  : <span class="kr">forall</span> <span class="nv">x</span>, subgroup_grp_op (subgroup_product H K) x
    &lt;-&gt; subgroup_product (subgroup_grp_op H) (subgroup_grp_op K) x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : grp_op G,
subgroup_grp_op (subgroup_product H K) x &lt;-&gt;
subgroup_product (subgroup_grp_op H)
  (subgroup_grp_op K) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1da"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : grp_op G,
subgroup_grp_op (subgroup_product H K) x &lt;-&gt;
subgroup_product (subgroup_grp_op H)
  (subgroup_grp_op K) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1db"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_grp_op (subgroup_product H K) x &lt;-&gt;
subgroup_product (subgroup_grp_op H)
  (subgroup_grp_op K) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1dc"><span class="nb">apply</span> subgroup_eq_subgroup_generated_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>H, K</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>grp_op G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
H g + K g &lt;-&gt;
subgroup_grp_op H g + subgroup_grp_op K g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** *** Paths between generated subgroups *)</span>

<span class="sd">(** This gets used twice in [path_subgroup_generated], so we factor it out here. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1dd"><span class="kn">Local Lemma</span> <span class="nf">path_subgroup_generated_helper</span> {<span class="nv">G</span> : Group}
  (<span class="nv">X</span> <span class="nv">Y</span> : G -&gt; <span class="kt">Type</span>) (<span class="nv">K</span> : <span class="kr">forall</span> <span class="nv">g</span>, merely (X g) -&gt; merely (Y g))
  : <span class="kr">forall</span> <span class="nv">g</span>, Trunc (-<span class="mi">1</span>) (subgroup_generated_type X g)
         -&gt; Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (subgroup_generated_type X g) -&gt;
Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1de"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (subgroup_generated_type X g) -&gt;
Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1df"><span class="nb">intro</span> g; <span class="nb">apply</span> Trunc_rec; <span class="nb">intro</span> ing.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>ing</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e0"><span class="nb">induction</span> ing <span class="kr">as</span> [g x| |g h Xg IHYg Xh IHYh].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1e1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1e1"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y <span class="mi">1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1e2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xg</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>Xh</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br><span><var>IHYg</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</span></span></span><br><span><var>IHYh</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y h)</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1e2"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y (g * h^))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Trunc_functor (-<span class="mi">1</span>) sgt_in (K g (tr x))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (tr sgt_unit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xg</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>Xh</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br><span><var>IHYg</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y g)</span></span></span><br><span><var>IHYh</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y h)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y (g * h^))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e6">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G, merely (X g) -&gt; merely (Y g)</span></span></span><br><span><var>g, h</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Xg</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X g</span></span></span><br><span><var>Xh</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type X h</span></span></span><br><span><var>IHYh</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type Y h</span></span></span><br><span><var>IHYg</var><span class="hyp-type"><b>: </b><span>subgroup_generated_type Y g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (subgroup_generated_type Y (g * h^))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> tr, sgt_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If the predicates selecting the generators are merely equivalent, then the generated subgroups are equal. (One could probably prove that the generated subgroup are isomorphic without using univalence.) *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e7"><span class="kn">Definition</span> <span class="nf">path_subgroup_generated</span> `{Univalence} {G : Group}
  (X Y : G -&gt; <span class="kt">Type</span>) (K : <span class="kr">forall</span> <span class="nv">g</span>, Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g))
  : subgroup_generated X = subgroup_generated Y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X = subgroup_generated Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X = subgroup_generated Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1e9">rapply equiv_path_subgroup&#39;. <span class="c">(* Uses Univalence. *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">g</span> : G,
subgroup_generated X g &lt;-&gt; subgroup_generated Y g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ea"><span class="nb">intro</span> g; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X g -&gt; subgroup_generated Y g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1eb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1eb"><hr></label><div class="goal-conclusion">subgroup_generated Y g -&gt; subgroup_generated X g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ec">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated X g -&gt; subgroup_generated Y g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_subgroup_generated_helper, (<span class="kr">fun</span> <span class="nv">x</span> =&gt; fst (K x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ed">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>G -&gt; <span class="kt">Type</span></span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">g</span> : G,
Trunc (-<span class="mi">1</span>) (X g) &lt;-&gt; Trunc (-<span class="mi">1</span>) (Y g)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated Y g -&gt; subgroup_generated X g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_subgroup_generated_helper, (<span class="kr">fun</span> <span class="nv">x</span> =&gt; snd (K x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Equal subgroups have isomorphic underlying groups. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_subgroup_group</span> {<span class="nv">G</span> : Group} (<span class="nv">H1</span> <span class="nv">H2</span> : Subgroup G)
  : H1 = H2 -&gt; GroupIsomorphism H1 H2
  := <span class="kp">ltac</span>:(<span class="nb">intros</span> []; <span class="bp">exact</span> grp_iso_id).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Image of a group homomorphism *)</span>

<span class="sd">(** The image of a group homomorphism between groups is a subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ee"><span class="kn">Definition</span> <span class="nf">grp_image</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) : Subgroup H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1ef"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f0">srapply (Build_Subgroup&#39; (<span class="kr">fun</span> <span class="nv">y</span> =&gt; hexists (<span class="kr">fun</span> <span class="nv">x</span> =&gt; f x = y))); <span class="nb">cbn</span> beta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hexists (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; f x = <span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1f1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1f1"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : H,
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = x) -&gt;
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = y) -&gt;
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = x * y^)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hexists (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; f x = <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f3"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : G &amp; f x = <span class="mi">1</span>}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f4"><span class="kr">exists</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f <span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> grp_homo_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : H,
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = x) -&gt;
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = y) -&gt;
hexists (<span class="kr">fun</span> <span class="nv">x0</span> : G =&gt; f x0 = x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f6"><span class="nb">intros</span> x y p q; strip_truncations; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>{x : G &amp; f x = y}</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>{x0 : G &amp; f x0 = x}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : G &amp; f x0 = x * y^}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f7"><span class="nb">destruct</span> p <span class="kr">as</span> [a p], q <span class="kr">as</span> [b q].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f b = y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : G &amp; f x0 = x * y^}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f8"><span class="kr">exists</span> (<span class="nv">a</span> * b^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f b = y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (a * b^) = x * y^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1f9">lhs napply grp_homo_op; f_ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f b = y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f b^ = y^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">lhs napply grp_homo_inv; f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">grp_image_in</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  : <span class="kr">forall</span> <span class="nv">x</span>, grp_image f (f x)
  := <span class="kr">fun</span> <span class="nv">x</span> =&gt; tr (x; idpath).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">grp_homo_image_in</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  : G $-&gt; grp_image f
  := subgroup_corec f (grp_image_in f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Image of a group embedding *)</span>

<span class="sd">(** When the homomorphism is an embedding, we don&#39;t need to truncate. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1fa"><span class="kn">Definition</span> <span class="nf">grp_image_embedding</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) `{IsEmbedding f}
  : Subgroup H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1fb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subgroup H</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1fc">snapply (Build_Subgroup _ (hfiber f)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSubgroup (hfiber f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk1fd"><span class="kp">repeat</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, IsHProp (hfiber f x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1fe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1fe"><hr></label><div class="goal-conclusion">hfiber f <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk1ff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk1ff"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : H,
hfiber f x -&gt; hfiber f y -&gt; hfiber f (x * y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk200" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk200"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, hfiber f x -&gt; hfiber f x^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk201">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, IsHProp (hfiber f x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk202">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber f <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (mon_unit; grp_homo_unit f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk203">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : H,
hfiber f x -&gt; hfiber f y -&gt; hfiber f (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk204"><span class="nb">intros</span> x y [a []] [b []].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber f (f a * f b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk205"><span class="kr">exists</span> (<span class="nv">a</span> * b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (a * b) = f a * f b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> grp_homo_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk206">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, hfiber f x -&gt; hfiber f x^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk207"><span class="nb">intros</span> b [a []].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber f (f a)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk208"><span class="kr">exists</span> <span class="nv">a</span>^.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a^ = (f a)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> grp_homo_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk209"><span class="kn">Definition</span> <span class="nf">grp_image_in_embedding</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) `{IsEmbedding f}
  : GroupIsomorphism G (grp_image_embedding f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism G (grp_image_embedding f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism G (grp_image_embedding f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20b">snapply Build_GroupIsomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupHomomorphism G (grp_image_embedding f)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk20c"><hr></label><div class="goal-conclusion">IsEquiv <span class="nl">?grp_iso_homo</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupHomomorphism G (grp_image_embedding f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20e">snapply (subgroup_corec f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G, grp_image_embedding f (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (x; idpath)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk20f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (subgroup_corec f (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (x; <span class="mi">1</span>%path)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk210"><span class="nb">apply</span> isequiv_surj_emb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>))
  (subgroup_corec f (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (x; <span class="mi">1</span>%path)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk211" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk211"><hr></label><div class="goal-conclusion">IsEmbedding
  (subgroup_corec f (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (x; <span class="mi">1</span>%path)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk212"><span class="mi">2</span>: <span class="bp">exact</span> (cancelL_isembedding (g:=pr1)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>))
  (subgroup_corec f (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (x; <span class="mi">1</span>%path)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk213"><span class="nb">intros</span> [b [a p]]; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (f x; x; <span class="mi">1</span>%path)) (b; a; p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk214">rapply contr_inhabited_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tr (-<span class="mi">1</span>)
  (hfiber (<span class="kr">fun</span> <span class="nv">x</span> : G =&gt; (f x; x; <span class="mi">1</span>%path)) (b; a; p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk215"><span class="nb">refine</span> (tr (a; _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f a; a; <span class="mi">1</span>%path) = (b; a; p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk216">srapply path_sigma&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk217" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk217"><hr></label><div class="goal-conclusion">transport (hfiber f) <span class="nl">?p</span> (a; <span class="mi">1</span>%path) = (a; p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk218"><span class="mi">1</span>: <span class="bp">exact</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (hfiber f) p (a; <span class="mi">1</span>%path) = (a; p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk219"><span class="nb">refine</span> (transport_sigma&#39; _ _ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a; <span class="mi">1</span>%path).<span class="mi">1</span>;
transport (<span class="kr">fun</span> <span class="nv">x</span> : H =&gt; f (a; <span class="mi">1</span>%path).<span class="mi">1</span> = x) p
  (a; <span class="mi">1</span>%path).<span class="mi">2</span>) = (a; p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> path_sigma_hprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The image of a surjective group homomorphism is the maximal subgroup. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21a"><span class="kn">Instance</span> <span class="nf">ismaximal_image_issurj</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : G $-&gt; H) `{IsSurjection f}
  : IsMaximalSubgroup (grp_image f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMaximalSubgroup (grp_image f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMaximalSubgroup (grp_image f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21c">rapply conn_map_elim.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : G, grp_image f (f a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> grp_image_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Image of a subgroup under a group homomorphism *)</span>

<span class="sd">(** The image of a subgroup under group homomorphism. *)</span> 
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_image</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  : Subgroup G -&gt; Subgroup H
  := <span class="kr">fun</span> <span class="nv">K</span> =&gt; grp_image (grp_homo_restr f K).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** By definition, values of [f x] where [x] is in a subgroup [J] are in the image of [J] under [f]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">subgroup_image_in</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">J</span> : Subgroup G)
  : <span class="kr">forall</span> <span class="nv">x</span>, J x -&gt; subgroup_image f J (f x)
  := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">Jx</span> =&gt; tr ((x; Jx); idpath).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Converting the subgroups to groups, we get the expected surjective (epi) restriction homomorphism. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">grp_homo_subgroup_image_in</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">J</span> : Subgroup G)
  : subgroup_group J $-&gt; subgroup_group (subgroup_image f J)
  := functor_subgroup_group f (subgroup_image_in _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The restriction map from the subgroup to the image is surjective as expected, by [conn_map_factor1_image]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issurj_grp_homo_subgroup_image_in</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : G $-&gt; H) (<span class="nv">J</span> : Subgroup G)
  : IsSurjection (grp_homo_subgroup_image_in f J)
  := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** An image of a subgroup [J] is included in a subgroup [K] if (and only if) [J] is included in the preimage of the subgroup [K]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21d"><span class="kn">Definition</span> <span class="nf">subgroup_image_rec</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : G $-&gt; H) {<span class="nv">J</span> : Subgroup G} {<span class="nv">K</span> : Subgroup H}
  (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span>, J x -&gt; K (f x))
  : <span class="kr">forall</span> <span class="nv">x</span>, subgroup_image f J x -&gt; K x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; K (f x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk21f"><span class="nb">intros</span> x; <span class="nb">apply</span> Trunc_rec; <span class="nb">intros</span> [[j Jj] p].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; K (f x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jj</var><span class="hyp-type"><b>: </b><span>J j</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>grp_homo_restr f J (j; Jj) = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk220"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; K (f x)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jj</var><span class="hyp-type"><b>: </b><span>J j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K (grp_homo_restr f J (j; Jj))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (g j Jj).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The image functor is adjoint to the preimage functor. *)</span> 
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk221"><span class="kn">Definition</span> <span class="nf">iff_subgroup_image_rec</span> {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : G $-&gt; H) {<span class="nv">J</span> : Subgroup G} {<span class="nv">K</span> : Subgroup H}
  : (<span class="kr">forall</span> <span class="nv">x</span>, subgroup_image f J x -&gt; K x)
    &lt;-&gt; (<span class="kr">forall</span> <span class="nv">x</span>, J x -&gt; subgroup_preimage f K x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk222"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x) &lt;-&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk223"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="subgroup-v-chk224" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><label class="goal-separator" for="subgroup-v-chk224"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk225">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk226"><span class="nb">intros</span> rec x Jx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>rec</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_preimage f K x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk227"><span class="nb">apply</span> rec, tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br><span><var>rec</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : J &amp; grp_homo_restr f J x0 = f x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">x</span>; Jx).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk228">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>Subgroup H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : G, J x -&gt; subgroup_preimage f K x) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : H, subgroup_image f J x -&gt; K x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">snapply subgroup_image_rec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** [subgroup_image] preserves normal subgroups when the group homomorphism is surjective. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk229"><span class="kn">Instance</span> <span class="nf">isnormal_subgroup_image</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  (<span class="nv">J</span> : Subgroup G) `{!IsNormalSubgroup J} `{!IsSurjection f}
  : IsNormalSubgroup (subgroup_image f J).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_image f J)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsNormalSubgroup (subgroup_image f J)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22b">snapply Build_IsNormalSubgroup&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : H,
subgroup_image f J x -&gt;
subgroup_image f J (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22c"><span class="nb">intros</span> x y; <span class="nb">revert</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H,
subgroup_image f J x -&gt;
subgroup_image f J (y * x * y^)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22d"><span class="nb">change</span> (subgroup_image f J (y * <span class="nl">?x</span> * y^))
    <span class="kr">with</span> (subgroup_preimage (grp_conj y) (subgroup_image f J) x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : H,
subgroup_image f J x -&gt;
subgroup_preimage (grp_conj y) (subgroup_image f J) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22e">snapply subgroup_image_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : G,
J x -&gt;
subgroup_preimage 
  (grp_conj y) (subgroup_image f J) 
  (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk22f"><span class="nb">intros</span> x Jx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_preimage 
  (grp_conj y) (subgroup_image f J) 
  (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk230"><span class="nb">change</span> (subgroup_image f J ((grp_conj y $o f) x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_image f J ((grp_conj y $o f) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk231"><span class="nb">revert</span> y; rapply (conn_map_elim (Tr (-<span class="mi">1</span>)) f); <span class="nb">intros</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_image f J ((grp_conj (f y) $o f) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk232"><span class="nb">rewrite</span> &lt;- grp_homo_conj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_image f J ((f $o grp_conj y) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk233">napply subgroup_image_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>J</var><span class="hyp-type"><b>: </b><span>Subgroup G</span></span></span><br><span><var>IsNormalSubgroup0</var><span class="hyp-type"><b>: </b><span>IsNormalSubgroup J</span></span></span><br><span><var>IsSurjection0</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>Jx</var><span class="hyp-type"><b>: </b><span>J x</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">J (grp_conj y x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> rapply isnormal_conj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Kernels of group homomorphisms *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">grp_kernel</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  : NormalSubgroup G
  := Build_NormalSubgroup G (subgroup_preimage f (trivial_subgroup _)) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Corecursion principle for group kernels *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk234"><span class="kn">Definition</span> <span class="nf">grp_kernel_corec</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">G</span> : Group} {<span class="nv">f</span> : A $-&gt; B}
  (<span class="nv">g</span> : G $-&gt; A) (<span class="nv">h</span> : f $o g == grp_homo_const)
  : G $-&gt; grp_kernel f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>f $o g == grp_homo_const</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $-&gt; grp_kernel f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk235"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G $-&gt; A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>f $o g == grp_homo_const</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G $-&gt; grp_kernel f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">snapply (subgroup_corec g); <span class="bp">exact</span> h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_grp_kernel_corec</span> `{Funext} {A B G : Group} {f : A $-&gt; B}
  : {g : G $-&gt; A &amp; f $o g == grp_homo_const} &lt;~&gt; (G $-&gt; grp_kernel f)
  := equiv_subgroup_corec G (grp_kernel f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The underlying map of a group homomorphism with a trivial kernel is an embedding. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk236"><span class="kn">Instance</span> <span class="nf">isembedding_istrivial_kernel</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  (<span class="nv">triv</span> : IsTrivialGroup (grp_kernel f))
  : IsEmbedding f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk237"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk238"><span class="nb">intros</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (hfiber f h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk239"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : hfiber f h, x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23a"><span class="nb">intros</span> [x p] [y q].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; p) = (y; q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23b">srapply path_sigma_hprop; <span class="nb">unfold</span> pr1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23c" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23c"><span class="nb">apply</span> grp_moveL_1M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x * y^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23d"><span class="nb">apply</span> triv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (x * y^) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23e">rhs_V <span class="bp">exact</span> (grp_inv_r h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (x * y^) = h * h^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk23f">lhs napply grp_homo_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x * f y^ = h * h^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk240">napply (ap011 (.*.) p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f y^ = h^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk241">lhs napply grp_homo_inv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>triv</var><span class="hyp-type"><b>: </b><span>IsTrivialGroup (grp_kernel f)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>H</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = h</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = h</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f y)^ = h^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap (^) q).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If the underlying map of a group homomorphism is an embedding then the kernel is trivial. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk242"><span class="kn">Definition</span> <span class="nf">istrivial_kernel_isembedding</span> {<span class="nv">G</span> <span class="nv">H</span> : Group} (<span class="nv">f</span> : G $-&gt; H)
  (<span class="nv">emb</span> : IsEmbedding f)
  : IsTrivialGroup (grp_kernel f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>emb</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup (grp_kernel f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk243" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk243"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>emb</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup (grp_kernel f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk244" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk244"><span class="nb">intros</span> g p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>emb</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>grp_kernel f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">trivial_subgroup G g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk245" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk245">rapply (isinj_embedding f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br><span><var>emb</var><span class="hyp-type"><b>: </b><span>IsEmbedding f</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>grp_kernel f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f g = f <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (p @ (grp_homo_unit f)^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Global</span> <span class="kn">Hint Immediate</span> istrivial_kernel_isembedding : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Characterisation of group embeddings *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk246" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk246"><span class="kn">Proposition</span> <span class="nf">equiv_istrivial_kernel_isembedding</span> `{F : Funext}
  {G H : Group} (f : G $-&gt; H)
  : IsTrivialGroup (grp_kernel f) &lt;~&gt; IsEmbedding f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup (grp_kernel f) &lt;~&gt; IsEmbedding f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk247"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup (grp_kernel f) &lt;~&gt; IsEmbedding f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="subgroup-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="subgroup-v-chk248"><span class="nb">apply</span> equiv_iff_hprop_uncurried.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsTrivialGroup (grp_kernel f) &lt;-&gt; IsEmbedding f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
